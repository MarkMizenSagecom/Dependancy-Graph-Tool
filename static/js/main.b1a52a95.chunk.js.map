{"version":3,"sources":["redux/user/userSlice.js","components/Guard.js","redux/dependancies/dependanciesSlice.js","components/FirebaseSync.js","features/Tree/TreeContext.js","hooks/useViewport.js","features/Tree/DraggableGroup.js","features/Tree/TreeActions.js","data/statuses.js","redux/options/optionsSlice.js","features/Tree/TreeNode.js","features/Tree/TreeArrows.js","features/Tree/TreeContents.js","features/Tree/TreeView.js","context/clickAndDrag.js","context/refs.js","redux/connections/connectionsSlice.js","redux/linking/linkingSlice.js","features/Columns/Connections.js","features/Columns/NodeEditor.js","features/Comments/SingleComment.js","features/Comments/CommentHistory.js","features/Comments/NewComment.js","features/Comments/Comments.js","features/Columns/ColumnItem.js","features/Columns/Column.js","features/Columns/ColumnsView.js","components/UserDetails.js","components/SearchResults.js","components/ComponentSearch.js","components/ShowHideAllArrows.js","components/ShowHideOtherRelations.js","components/SaveButton.js","components/AppSidebar.js","App.js","redux/store.js","serviceWorker.js","firebaseConfig.js","index.js"],"names":["WRITE_ACCESS","userSlice","createSlice","name","initialState","noSignIn","userDetails","uid","email","photoURL","displayName","signedIn","writeAccess","commentAccess","reducers","logOut","setNoSignIn","state","action","payload","setUser","includes","actions","getUserDetails","user","getSignedIn","getWriteAccess","getReadOnly","getCommentAccess","getNoSignIn","GuardWrap","styled","div","Guard","children","isSignedIn","useSelector","dispatch","useDispatch","console","log","uiConfig","signInFlow","signInOptions","firebase","auth","GoogleAuthProvider","PROVIDER_ID","callbacks","signInSuccessWithAuthResult","type","align","mb","variant","firebaseAuth","onClick","genId","prefix","Math","random","toString","substr","dependanciesSlice","saving","shouldLoad","items","connections","columns","addItem","column","id","partial","now","Date","title","description","status","updated","seconds","floor","milliseconds","genItem","unshift","removeItem","Object","keys","find","col","findIndex","item","filter","thisItem","from","to","updateItem","update","moveItem","newPos","startPos","splice","addColumn","removeColumn","updateColumn","addConnection","existing","conn","push","removeConnection","updateAll","save","saved","getItems","dependancies","getColumns","getConnections","getShouldLoad","getShouldSave","getSaving","FirebaseSync","shouldSave","firestore","useFirestore","useEffect","Promise","all","collection","get","then","itemsData","columnsData","connectionsData","itemsValues","docs","forEach","doc","data","columnsValues","connectionsValues","map","batch","ref","delete","indexOf","set","connection","index","String","commit","catch","err","finally","warn","TreeContext","createContext","TreeContextProvider","itemId","useParams","useState","zoom","_setZoom","setZoom","useCallback","amount","isNaN","max","min","nodesToShow","rel","colKeys","rowLength","columnsLength","colKey","rowCount","nodeToShowIndex","node","row","nodes","descendants","length","ancesstors","position","x","FRAME_WIDTH","y","active","Provider","value","maxColumns","useViewport","width","window","innerWidth","height","innerHeight","viewport","setViewport","handleWindowResize","addEventListener","removeEventListener","reducer","scale","transform","start","prev","mouseDown","DraggableGroup","useReducer","dragging","useContext","requestAnimationFrame","outerTransform","useMemo","eventHandler","document","fill","onMouseDown","ev","clientX","clientY","onMouseMove","onMouseUp","style","userSelect","ButtonWrap","TreeActions","context","fontWeight","size","iconType","statuses","unknown","color","text","stable","underReview","unstable","outdated","deprecated","optionsSlice","showOtherRelations","showAllArrows","setOption","key","toggleOption","getShowOtherRelations","options","getShowAllArrows","NodeTitle","NodeColumn","NodeBox","rect","props","root","StatusBox","OtherNodeLabel","parentX","parentY","line","d","strokeWidth","stroke","cx","cy","r","textAnchor","dominantBaseline","TreeNode","selected","itemDetails","descendantsLabel","ancesstorsLabel","TreeArrowsG","g","TreeArrows","activePosition","xStart","yStart","xEnd","yEnd","triangle","points","TreeContents","history","useHistory","switchItem","TreeViewWrap","TreeViewSVG","svg","TreeView","viewbox","svgProps","setSvgProps","preserveAspectRatio","xmlns","ClickAndDrag","ClickAndDragProvider","setState","drag","drop","linking","Refs","newState","RefsProvider","addRef","removeRef","refs","connectionsSlice","scrollLeft","updateScrollLeft","getScrollLeft","linkingSlice","source","startLinking","doneLinking","getLinkingSource","getIsLinking","ConnectionsWrap","Svg","Connections","linkingSource","refsContext","viewBox","useRef","lines","scrollTop","documentElement","filterMethod","fromRef","toRef","fromClientRect","getBoundingClientRect","right","top","toClientRect","abs","left","current","ItemButtons","Circle","span","formDataReducer","val","NodeEditor","doneEditing","confirmDelete","setConfirmDelete","formData","formDataDispatch","onSubmit","preventDefault","labelInline","label","onChange","target","required","buttonType","open","onConfirm","onCancel","CommentMeta","CommentContent","CommentAuthor","CommentWrap","SingleComment","comment","deleteComment","dateFormatted","datetime","toLocaleString","weekday","year","month","fromSelf","author","className","tabIndex","content","destructive","CommentHistoryBox","NoComments","CommentHistory","comments","Actions","Form","form","NewComment","message","setMessage","trim","rows","ml","Comments","close","itemRef","messagesRef","threadMessages","useFirestoreCollectionData","idField","sort","a","b","Ta","Tb","addComment","messageCount","add","CommentBtnWrap","ColumnItemEle","ReadOnlyView","ColumnItem","edittable","setEdittable","showComments","setShowComments","readonly","startEditing","querySelector","focus","viewTree","addLink","startLinkingFromNode","exitlinking","orientation","pixelWidth","cursor","fontSize","borderColor","disabled","onAction","ColumnEle","ColumnVerticalList","justify","ColumnTitle","ColumnTitleText","h2","ColumnTitleEditable","input","EditableWrap","EditableIcon","Column","colId","titleInput","bgTheme","bgSize","ColumnsViewWrap","ColumnsScrollableWrap","Provders","ColumnsView","scrollable","handleScroll","onScroll","UserDetailsWrap","UserDetails","mt","fullWidth","src","signOut","ItemActions","ItemList","ul","Item","li","SearchResults","searchTerm","searchSelector","toLowerCase","results","as","listStyleType","pl","SearchWrap","SearchLabel","ComponentSearch","setSearchTerm","placeholder","e","searchButton","Wrap","ShowHideAllArrows","grouped","checked","ShowHideOtherRelations","SaveButton","handleClick","isInsideButton","SidebarWrap","SidebarActions","Hr","hr","AppSidebar","path","goBack","exact","AppWrap","App","component","configureStore","linkingReducer","dependanciesReducer","connectionsReducer","optionsReducer","userReducer","Boolean","location","hostname","match","firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","ReactDOM","render","StrictMode","store","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.b1a52a95.chunk.js","sourcesContent":["import { createSlice } from \"@reduxjs/toolkit\";\n\nconst WRITE_ACCESS = [\n  \"hFgfQcppuQXWOjHC72Cs7XK0uQ52\", // Mark\n  \"6ml6AfPeOjSEVWnFidImp8Bppnd2\", // Alexa\n  \"3PFfEGHNeZYk89POk991YEQKJXj2\", // Ingrid\n];\n\nexport const userSlice = createSlice({\n  name: \"user\",\n  initialState: {\n    noSignIn: true,\n    userDetails: {\n      uid: null,\n      email: null,\n      photoURL: null,\n      displayName: null,\n    },\n    signedIn: false,\n    writeAccess: false,\n    commentAccess: false,\n  },\n  reducers: {\n    logOut: () => {\n      return {\n        noSignIn: false,\n        userDetails: {\n          uid: null,\n          email: null,\n          photoURL: null,\n          displayName: null,\n        },\n        signedIn: false,\n        writeAccess: false,\n        commentAccess: false,\n      };\n    },\n    setNoSignIn: (state, action) => {\n      return { ...state, noSignIn: action.payload };\n    },\n    setUser: (state, action) => {\n      if (action.payload) {\n        state.userDetails = {\n          uid: action.payload.uid,\n          email: action.payload.email,\n          photoURL: action.payload.photoURL,\n          displayName: action.payload.displayName,\n        };\n        state.noSignIn = false;\n        state.signedIn = true;\n        state.writeAccess = WRITE_ACCESS.includes(action.payload.uid);\n        state.commentAccess = state.writeAccess\n          ? true\n          : action.payload.email.includes(\"@sage.com\");\n      } else {\n        state.noSignIn = false;\n        state.userDetails = {\n          uid: null,\n          email: null,\n          photoURL: null,\n        };\n        state.signedIn = false;\n        state.writeAccess = false;\n      }\n    },\n  },\n});\n\nexport const { setUser, logOut, setNoSignIn } = userSlice.actions;\n\nexport const getUserDetails = (state) => state?.user?.userDetails;\nexport const getSignedIn = (state) => state?.user?.signedIn;\nexport const getWriteAccess = (state) => state?.user?.writeAccess;\nexport const getReadOnly = (state) => !state?.user?.writeAccess;\nexport const getCommentAccess = (state) => state?.user?.commentAccess;\nexport const getNoSignIn = (state) => state?.user?.noSignIn;\n\nexport default userSlice.reducer;\n","import React from \"react\";\nimport firebase from \"firebase\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport FirebaseAuth from \"react-firebaseui/FirebaseAuth\";\n\nimport Typography from \"carbon-react/lib/components/typography\";\n\nimport { getNoSignIn, setNoSignIn, setUser } from \"../redux/user/userSlice\";\nimport { getSignedIn } from \"../redux/user/userSlice\";\nimport styled from \"styled-components\";\nimport Tile from \"carbon-react/lib/components/tile\";\nimport Content from \"carbon-react/lib/components/content\";\nimport Button from \"carbon-react/lib/components/button\";\n\nconst GuardWrap = styled.div`\n  display: flex;\n  flex-direction: column;\n  margin: 2rem auto;\n  width: 600px;\n  max-width: 100%;\n  font-size: 16px;\n`;\n\nfunction Guard({ children }) {\n  const isSignedIn = useSelector(getSignedIn);\n  const noSignIn = useSelector(getNoSignIn);\n  const dispatch = useDispatch();\n\n  console.log({noSignIn});\n\n  if (noSignIn || isSignedIn) {\n    return <>{children}</>;\n  }\n\n  const uiConfig = {\n    // Popup signin flow rather than redirect flow.\n    signInFlow: \"popup\",\n    // We will display Google and Facebook as auth providers.\n    signInOptions: [firebase.auth.GoogleAuthProvider.PROVIDER_ID],\n    callbacks: {\n      signInSuccessWithAuthResult({ user }) {\n        const userDetails = {\n          uid: user.uid,\n          email: user.email,\n          photoURL: user.photoURL,\n          displayName: user.displayName,\n        };\n        dispatch({ type: setUser.type, payload: userDetails });\n        return false;\n      },\n    },\n  };\n\n  return (\n    <GuardWrap>\n      <Tile>\n        <Content align=\"center\">\n          <Typography mb={4} variant=\"h1-large\">\n            Dependancy Graph\n          </Typography>\n          <p>Please sign in using SSO</p>\n          <FirebaseAuth uiConfig={uiConfig} firebaseAuth={firebase.auth()} />\n\n          <p>Or</p>\n          <Button\n            variant=\"secondary\"\n            onClick={() => {\n              dispatch({ type: setNoSignIn, payload: true });\n            }}\n          >\n            Continue without signing in\n          </Button>\n        </Content>\n      </Tile>\n    </GuardWrap>\n  );\n}\n\nexport default Guard;\n","import { createSlice } from \"@reduxjs/toolkit\";\n\nconst genId = (prefix = \"item\") =>\n  `${prefix}-${Math.random()\n    .toString()\n    .substr(2, 8)}${Math.random().toString().substr(2, 8)}`;\n\nconst genItem = (partial = {}) => {\n  const now = new Date();\n  return {\n    title: \"Name\",\n    description: \"\",\n    status: \"unknown\",\n    updated: {\n      seconds: Math.floor(now / 1000),\n      milliseconds: now % 1000,\n    },\n    ...partial,\n  };\n};\n\nexport const dependanciesSlice = createSlice({\n  name: \"dependancies\",\n  initialState: {\n    saving: false,\n    shouldLoad: true,\n    items: {},\n    connections: [],\n    columns: {},\n  },\n  reducers: {\n    addItem: (state, action) => {\n      const { column } = action.payload;\n      let id = genId();\n      // Make sure there are no id conflicts.\n      // Should be very low, but non-zero, chance\n      while (!!state.items[id]) {\n        id = genId();\n      }\n      state.items[id] = genItem();\n      state.columns[column].items.unshift(id);\n\n      return state;\n    },\n    removeItem: (state, action) => {\n      const { id } = action.payload;\n\n      // Delete the item\n      delete state.items[id];\n\n      // Get the correct column to remove it from\n      const column = Object.keys(state.columns).find((col) => {\n        return state.columns[col]?.items?.findIndex((item) => item === id) > -1;\n      });\n\n      if (column) {\n        // Filter it from the column\n        state.columns[column].items = state.columns[column].items.filter(\n          (thisItem) => thisItem !== id\n        );\n      }\n\n      state.connections = state.connections.filter(\n        ({ from, to }) => from !== id && to !== id\n      );\n\n      return state;\n    },\n    updateItem: (state, action) => {\n      const { id, update } = action.payload;\n      state.items[id] = {\n        ...state.items[id],\n        ...update,\n      };\n    },\n    moveItem: (state, action) => {\n      const { id, newPos, from, to } = action.payload;\n      const startPos = state.columns[from].items.findIndex(id);\n\n      // If from and to are the same then this will still work, so no case needs to be added\n\n      // Remove from original array:\n      state.columns[from].items.splice(startPos, 1);\n\n      // Add to target array\n      state.columns[to].items.splice(newPos, 0, id);\n\n      return state;\n    },\n    addColumn: (state) => {\n      const id = genId(\"column-\");\n\n      state.columns[id] = {\n        title: \"Column title\",\n        items: [],\n      };\n    },\n    removeColumn: (state, action) => {\n      const { id } = action.payload;\n      delete state.columns[id];\n    },\n    updateColumn: (state, action) => {\n      const { id, ...update } = action.payload;\n\n      return {\n        ...state,\n        columns: {\n          ...state.columns,\n          [id]: {\n            ...state.columns[id],\n            ...update,\n          },\n        },\n      };\n    },\n    addConnection: (state, action) => {\n      const { to, from } = action.payload;\n      const existing = state.connections.findIndex(\n        (conn) => conn.to === to && conn.from === from\n      );\n      if (existing > -1) {\n        state.connections.splice(existing, 1);\n      } else {\n        state.connections.push({ to, from });\n      }\n    },\n    removeConnection: (state, action) => {\n      const { to, from } = action.payload;\n      state.connections = state.connections.filter(\n        (item) => item.to === to && item.from === from\n      );\n    },\n    updateAll: (state, action) => {\n      const { items, columns, connections } = action.payload;\n\n      state.items = items;\n      state.columns = columns;\n      state.connections = connections;\n      state.shouldLoad = false;\n    },\n    save: (state) => {\n      state.saving = true;\n    },\n    saved: (state) => {\n      state.saving = false;\n    },\n  },\n});\n\nexport const {\n  addItem,\n  removeItem,\n  updateItem,\n  moveItem,\n  addColumn,\n  updateColumn,\n  addConnection,\n  updateAll,\n  save,\n  saved,\n} = dependanciesSlice.actions;\n\nexport const getItems = (state) => state?.dependancies?.items;\nexport const getColumns = (state) => state?.dependancies?.columns;\nexport const getConnections = (state) => state?.dependancies?.connections;\nexport const getShouldLoad = (state) => state?.dependancies?.shouldLoad;\nexport const getShouldSave = (state) => state?.dependancies?.saving;\nexport const getSaving = (state) => state?.dependancies?.saving;\n\nexport default dependanciesSlice.reducer;\n","import { useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport {\n  getConnections,\n  getColumns,\n  getItems,\n  getShouldLoad,\n  getShouldSave,\n  updateAll,\n  saved,\n} from \"../redux/dependancies/dependanciesSlice\";\nimport { getWriteAccess } from \"../redux/user/userSlice\";\nimport { useFirestore } from \"reactfire\";\n\nfunction FirebaseSync() {\n  const shouldLoad = useSelector(getShouldLoad);\n  const writeAccess = useSelector(getWriteAccess);\n  const shouldSave = useSelector(getShouldSave);\n\n  const items = useSelector(getItems);\n  const connections = useSelector(getConnections);\n  const columns = useSelector(getColumns);\n\n  const dispatch = useDispatch();\n\n  const firestore = useFirestore();\n\n  useEffect(() => {\n    if (!shouldLoad) {\n      return;\n    }\n\n    Promise.all([\n      firestore.collection(\"items\").get(),\n      firestore.collection(\"columns\").get(),\n      firestore.collection(\"connections\").get(),\n    ]).then(([itemsData, columnsData, connectionsData]) => {\n      const itemsValues = {};\n      itemsData.docs.forEach((doc) => {\n        itemsValues[doc.id] = doc.data();\n      });\n\n      const columnsValues = {};\n      columnsData.docs.forEach((doc) => {\n        columnsValues[doc.id] = doc.data();\n      });\n\n      const connectionsValues = connectionsData.docs.map((doc) => {\n        const data = doc.data();\n        const { to, from } = data;\n        return { to, from };\n      });\n\n      dispatch({\n        type: updateAll.type,\n        payload: {\n          items: itemsValues,\n          columns: columnsValues,\n          connections: connectionsValues,\n        },\n      });\n    });\n  }, [shouldLoad, firestore, dispatch]);\n\n  useEffect(() => {\n    if (!shouldSave) {\n      return;\n    }\n    if (!writeAccess) {\n      console.warn(\"User doesn't have write access\");\n      dispatch({ type: saved.type });\n      return;\n    }\n\n    Promise.all([\n      firestore.collection(\"items\").get(),\n      firestore.collection(\"columns\").get(),\n      firestore.collection(\"connections\").get(),\n    ])\n      .then(([itemsData, columnsData, connectionsData]) => {\n        const batch = firestore.batch();\n\n        // Remove deleted items\n        itemsData.docs.forEach((doc) => {\n          if (!items[doc.id]) {\n            const ref = firestore.collection(\"items\").doc(doc.id);\n            batch.delete(ref);\n          }\n        });\n\n        // Remove deleted columns\n        columnsData.docs.forEach((doc) => {\n          if (!columns[doc.id]) {\n            const ref = firestore.collection(\"columns\").doc(doc.id);\n            batch.delete(ref);\n          }\n        });\n\n        // Reset all connections\n        connectionsData.docs.forEach((doc) => {\n          const ref = firestore.collection(\"connections\").doc(doc.id);\n          batch.delete(ref);\n        });\n\n        Object.keys(items).forEach((id) => {\n          const ref = firestore.collection(\"items\").doc(id);\n          if (itemsData.docs.indexOf((doc) => doc.id === id) === -1) {\n            batch.set(ref, items[id]);\n          } else {\n            batch.update(ref, items[id]);\n          }\n        });\n\n        Object.keys(columns).forEach((id) => {\n          const ref = firestore.collection(\"columns\").doc(id);\n          if (columnsData.docs.indexOf((doc) => doc.id === id) === -1) {\n            batch.set(ref, columns[id]);\n          } else {\n            batch.update(ref, columns[id]);\n          }\n        });\n\n        connections.forEach((connection, index) => {\n          const ref = firestore.collection(\"connections\").doc(String(index));\n          batch.set(ref, connection);\n        });\n\n        return batch.commit();\n      })\n      .then(() => {\n        console.log(\"batch executed\");\n      })\n      .catch((err) => {\n        console.log(\"batch failed\", err);\n      })\n      .finally(() => {\n        dispatch({ type: saved.type });\n      });\n  }, [\n    dispatch,\n    shouldSave,\n    writeAccess,\n    items,\n    connections,\n    columns,\n    firestore,\n  ]);\n\n  return null;\n}\nexport default FirebaseSync;\n","import { useParams } from \"react-router-dom\";\nimport { createContext } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport {\n  getColumns,\n  getConnections,\n} from \"../../redux/dependancies/dependanciesSlice\";\nimport { useState } from \"react\";\nimport { useCallback } from \"react\";\n\nconst FRAME_WIDTH = 2000;\n// const FRAME_HEIGHT = 2000;\n\nexport const TreeContext = createContext();\n\nexport function TreeContextProvider({ children }) {\n  const { itemId } = useParams();\n  const connections = useSelector(getConnections);\n  const columns = useSelector(getColumns);\n  const [zoom, _setZoom] = useState(100);\n\n  const setZoom = useCallback(\n    (amount) => {\n      if (isNaN(amount)) {\n        return;\n      }\n      _setZoom(Math.max(Math.min(amount, 200), 30));\n    },\n    [_setZoom]\n  );\n\n  let nodesToShow = [\n    {\n      rel: \"root\",\n      id: itemId,\n    },\n  ];\n\n  // Add all descendents and ancesstors\n  connections.forEach((connection) => {\n    if (connection.from === itemId) {\n      nodesToShow.push({\n        rel: \"descendant\",\n        id: connection.to,\n      });\n    }\n    if (connection.to === itemId) {\n      nodesToShow.push({\n        rel: \"ancesstor\",\n        id: connection.from,\n      });\n    }\n  });\n\n  // Assign the row and position in row\n  const colKeys = Object.keys(columns);\n\n  const rowLength = [];\n\n  let columnsLength = 0;\n\n  colKeys.forEach((colKey, index) => {\n    let rowCount = 0;\n    columns[colKey].items.forEach((item) => {\n      const nodeToShowIndex = nodesToShow.findIndex((node) => node.id === item);\n      if (nodeToShowIndex < 0) {\n        return;\n      }\n      nodesToShow[nodeToShowIndex].row = index;\n      nodesToShow[nodeToShowIndex].rowCount = rowCount++;\n      nodesToShow[nodeToShowIndex].col = columns[colKey].title;\n    });\n\n    rowLength[index] = rowCount;\n    columnsLength = Math.max(rowCount, columnsLength);\n  });\n\n  const nodes = nodesToShow.map((node) => {\n    return {\n      id: node.id,\n      rel: node.rel,\n      col: node.col,\n      descendants: connections.filter(({ from }) => from === node.id).length,\n      ancesstors: connections.filter(({ to }) => to === node.id).length,\n      position: {\n        x: FRAME_WIDTH / 2 + (rowLength[node.row] / 2 - node.rowCount) * 400,\n        y: node.row * 180,\n      },\n    };\n  });\n\n  const active = nodes.findIndex((node) => node.id === itemId);\n\n  return (\n    <TreeContext.Provider\n      value={{ nodes, maxColumns: columnsLength, active, zoom, setZoom }}\n    >\n      {children}\n    </TreeContext.Provider>\n  );\n}\n","import { useEffect, useState } from \"react\";\n\nconst useViewport = () => {\n  const [viewport, setViewport] = useState({\n    width: window.innerWidth,\n    height: window.innerHeight,\n  });\n\n  useEffect(() => {\n    const handleWindowResize = () => {\n      setViewport({\n        width: window.innerWidth,\n        height: window.innerHeight,\n      });\n    };\n    window.addEventListener(\"resize\", handleWindowResize);\n    return () => window.removeEventListener(\"resize\", handleWindowResize);\n  }, []);\n\n  // Return the width so we can use it in our components\n  return viewport;\n};\n\nexport default useViewport;\n","import { useEffect, useContext, useMemo, useReducer } from \"react\";\nimport { TreeContext } from \"./TreeContext\";\nimport useViewport from \"../../hooks/useViewport\";\nimport { useParams } from \"react-router\";\n\nfunction reducer(state, { type, payload }) {\n  switch (type) {\n    case \"RESET\":\n      return {\n        scale: 1,\n        transform: {\n          x: 0,\n          y: 0,\n        },\n        start: {\n          x: 0,\n          y: 0,\n        },\n        prev: {\n          x: 0,\n          y: 0,\n        },\n        mouseDown: false,\n      };\n    case \"SCALE\":\n      return {\n        ...state,\n        scale: payload.scale,\n        transform: {\n          x: 0,\n          y: 0,\n        },\n        prev: {\n          x: 0,\n          y: 0,\n        },\n      };\n    case \"MOUSE_DOWN\":\n      return {\n        ...state,\n        start: {\n          x: payload.x,\n          y: payload.y,\n        },\n        mouseDown: true,\n      };\n    case \"MOUSE_UP\":\n      return {\n        ...state,\n        mouseDown: false,\n        prev: { ...state.transform },\n      };\n    case \"MOVE\":\n      if (!state.mouseDown) {\n        return state;\n      }\n      const { start, prev } = state;\n      return {\n        ...state,\n        transform: {\n          x: prev.x - (start.x - payload.x),\n          y: prev.y - (start.y - payload.y),\n        },\n      };\n\n    default: {\n      return state;\n    }\n  }\n}\n\nfunction DraggableGroup({ children }) {\n  const { itemId } = useParams();\n  const [dragging, dispatch] = useReducer(reducer, {\n    scale: 1,\n    transform: {\n      x: 0,\n      y: 0,\n    },\n    start: {\n      x: 0,\n      y: 0,\n    },\n    prev: {\n      x: 0,\n      y: 0,\n    },\n    mouseDown: false,\n  });\n\n  const { nodes, active, zoom } = useContext(TreeContext);\n\n  useEffect(() => {\n    requestAnimationFrame(() => {\n      dispatch({ type: \"RESET\" });\n    });\n  }, [itemId, dispatch]);\n\n  useEffect(() => {\n    requestAnimationFrame(() => {\n      dispatch({ type: \"SCALE\", payload: { scale: zoom / 100 } });\n    });\n  }, [zoom, dispatch]);\n\n  const viewport = useViewport();\n\n  const outerTransform = useMemo(() => {\n    const x =\n      viewport.width / 2 -\n      (nodes[active].position.x) * dragging.scale -\n      160 - 150;\n    const y =\n      viewport.height / 2 - (nodes[active].position.y - 40) * dragging.scale;\n    return `translate(${x} ${y})`;\n  }, [viewport, nodes, active, dragging.scale]);\n\n  useEffect(() => {\n    const eventHandler = () => {\n      dispatch({ type: \"MOUSE_UP\" });\n    };\n    document.addEventListener(\"mouseleave\", eventHandler);\n    return () => {\n      document.removeEventListener(\"mouseleave\", eventHandler);\n    };\n  }, [dispatch]);\n\n  return (\n    <>\n      <rect\n        fill=\"transparent\"\n        width=\"2000\"\n        height=\"2000\"\n        onMouseDown={(ev) => {\n          dispatch({\n            type: \"MOUSE_DOWN\",\n            payload: { x: ev.clientX, y: ev.clientY },\n          });\n        }}\n        onMouseMove={(ev) => {\n          dispatch({\n            type: \"MOVE\",\n            payload: {\n              x: ev.clientX,\n              y: ev.clientY,\n            },\n          });\n        }}\n        onMouseUp={(ev) => {\n          dispatch({ type: \"MOUSE_UP\" });\n        }}\n      ></rect>\n      <g transform={outerTransform} style={{ userSelect: \"none\" }}>\n        <g\n          transform={`translate(${dragging.transform.x} ${dragging.transform.y}) scale(${dragging.scale})`}\n        >\n          {children}\n        </g>\n      </g>\n    </>\n  );\n}\nexport default DraggableGroup;\n","import { useContext } from \"react\";\nimport Button from \"carbon-react/lib/components/button\";\nimport styled from \"styled-components\";\nimport { TreeContext } from \"./TreeContext\";\nimport Typography from \"carbon-react/lib/components/typography\";\n\nconst ButtonWrap = styled.div`\n  position: absolute;\n  right: 1rem;\n  bottom: 1rem;\n`;\n\nfunction TreeActions() {\n  const context = useContext(TreeContext);\n  return (\n    <ButtonWrap>\n      <Typography mb={1} fontWeight=\"600\">Zoom: {context.zoom}%</Typography>\n      <Button\n        size=\"small\"\n        onClick={() => context.setZoom(context.zoom + 20)}\n        iconType=\"plus\"\n      >\n        Zoom In\n      </Button>\n      <Button\n        size=\"small\"\n        onClick={() => context.setZoom(context.zoom - 20)}\n        iconType=\"minus\"\n      >\n        Zoom Out\n      </Button>\n    </ButtonWrap>\n  );\n}\n\nexport default TreeActions;\n","const statuses = {\n  unknown: {\n    color: \"grey\",\n    text: \"Unknown\",\n    description: null,\n  },\n  stable: {\n    color: \"green\",\n    text: \"Stable\",\n    description: null,\n  },\n  underReview: {\n    color: \"orange\",\n    text: \"Under Review\",\n    description: null,\n  },\n  unstable: {\n    color: \"darkorange\",\n    text: \"Unstable\",\n    description: null,\n  },\n  outdated: {\n    color: \"red\",\n    text: \"Outdated \",\n    description: null,\n  },\n  deprecated: {\n    color: \"darkslategray\",\n    text: \"Deprecated\",\n    description: null,\n  },\n};\n\nexport default statuses;\n","import { createSlice } from \"@reduxjs/toolkit\";\n\nexport const optionsSlice = createSlice({\n  name: \"options\",\n  initialState: {\n    showOtherRelations: false,\n    showAllArrows: true,\n  },\n  reducers: {\n    setOption: (state, action) => {\n      const { key, value } = action.payload;\n      state[key] = value;\n    },\n    toggleOption: (state, action) => {\n      if (!action.payload) {\n        return;\n      }\n      state[action.payload] = !state[action.payload];\n    },\n  },\n});\n\nexport const { setOption, toggleOption } = optionsSlice.actions;\n\nexport const getShowOtherRelations = (state) =>\n  state?.options?.showOtherRelations;\n\nexport const getShowAllArrows = (state) => state?.options?.showAllArrows;\n\nexport default optionsSlice.reducer;\n","import { useSelector } from \"react-redux\";\nimport styled from \"styled-components\";\nimport statuses from \"../../data/statuses\";\nimport { getShowOtherRelations } from \"../../redux/options/optionsSlice\";\n\nconst NodeTitle = styled.text`\n  font: normal 18px sans-serif;\n  pointer-events: none;\n`;\n\n// const NodeDescription = styled.text`\n//   font: normal 14px sans-serif;\n//   pointer-events: none;\n// `;\n\nconst NodeColumn = styled.text`\n  font: normal 14px sans-serif;\n  pointer-events: none;\n`;\n\nconst NodeBox = styled.rect`\n  fill: #fff;\n  stroke: #8099a4;\n  stroke-width: 1;\n  filter: \n    drop-shadow(0 3px 3px rgba(0,20,29,0.2)) \n    drop-shadow(0 2px 4px rgba(0,20,29,0.15));\n  ${(props) =>\n    props.root\n      ? `\n      stroke-width: 2;\n      fill: rgb(242, 245, 246);\n      `\n      : `\n      &:hover {\n        stroke-width: 2;\n        stroke: #008200;\n        cursor: pointer;\n      }\n    `}}\n`;\n\nconst StatusBox = styled.rect`\n  stroke-width: 0;\n  ${(props) => {\n    if (statuses[props.status]) {\n      return `fill: ${statuses[props.status].color};`;\n    }\n    return `fill: transparent;`;\n  }}\n`;\n\nconst OtherNodeLabel = ({ x, y, parentX, parentY, text }) => {\n  const line = `M ${parentX} ${parentY}, L ${x} ${y}`;\n  return (\n    <g>\n      <path\n        d={line}\n        strokeWidth=\"2\"\n        fill=\"transparent\"\n        stroke=\"rgba(0, 0, 0, 0.4)\"\n      />\n      <circle\n        cx={x}\n        cy={y}\n        r=\"16\"\n        fill=\"#ffffff\"\n        stroke=\"#8099a4\"\n        strokeWidth=\"1\"\n      />\n      <text x={x} y={y} textAnchor=\"middle\" dominantBaseline=\"central\">\n        {text}\n      </text>\n    </g>\n  );\n};\n\nfunction TreeNode({\n  selected,\n  itemDetails,\n  position = { x: 0, y: 0 },\n  rel,\n  descendants,\n  ancesstors,\n  col,\n}) {\n  const showOtherRelations = useSelector(getShowOtherRelations);\n\n  let descendantsLabel = \"\";\n  let ancesstorsLabel = \"\";\n\n  if (rel === \"ancesstor\") {\n    descendantsLabel = descendants - 1 > 0 ? `+${descendants - 1}` : \"\";\n    ancesstorsLabel = ancesstors;\n  }\n\n  if (rel === \"descendant\") {\n    descendantsLabel = descendants;\n    ancesstorsLabel = ancesstors - 1 > 0 ? `+${ancesstors - 1}` : \"\";\n  }\n\n  return (\n    <>\n      <g onClick={selected}>\n        <NodeBox\n          root={rel === \"root\"}\n          x={position.x.toString()}\n          y={position.y.toString()}\n          height=\"80\"\n          width=\"300\"\n        />\n\n        <StatusBox\n          status={itemDetails?.status}\n          x={position.x.toString()}\n          y={position.y.toString()}\n          height=\"80\"\n          width=\"8\"\n        />\n\n        <NodeTitle\n          x={(position.x + 24).toString()}\n          y={(position.y + 30).toString()}\n        >\n          {itemDetails?.title}\n        </NodeTitle>\n\n        <NodeColumn\n          x={(position.x + 24).toString()}\n          y={(position.y + 60).toString()}\n        >\n          {col}\n        </NodeColumn>\n\n        {/* <NodeDescription\n          x={(position.x + 10).toString()}\n          y={(position.y + 60).toString()}\n        >\n          {itemDetails?.description}\n        </NodeDescription> */}\n      </g>\n\n      {showOtherRelations && (\n        <>\n          {descendantsLabel > 0 && (\n            <OtherNodeLabel\n              x={(position.x + 240).toString()}\n              y={(position.y + 80 + 40).toString()}\n              parentX={position.x + 240}\n              parentY={position.y + 80}\n              text={descendantsLabel}\n            />\n          )}\n\n          {ancesstorsLabel > 0 && (\n            <OtherNodeLabel\n              x={(position.x + 240).toString()}\n              y={(position.y - 40).toString()}\n              parentX={position.x + 240}\n              parentY={position.y}\n              text={ancesstorsLabel}\n            />\n          )}\n        </>\n      )}\n    </>\n  );\n}\nexport default TreeNode;\n","import { useMemo } from \"react\";\nimport styled from \"styled-components\";\n\nconst TreeArrowsG = styled.g`\n  pointer-events: none;\n`;\n\nfunction TreeArrows({\n  activePosition = { x: 0, y: 0 },\n  position = { x: 0, y: 0 },\n  rel,\n}) {\n  const [line, triangle] = useMemo(() => {\n    if (activePosition.y > position.y) {\n      const xStart = position.x + 150;\n      const yStart = position.y + 80;\n\n      const xEnd = activePosition.x + 150;\n      const yEnd = activePosition.y;\n\n      return [\n        ` M ${xStart} ${yStart},\n            C ${xStart} ${yStart + 100},\n            ${xEnd} ${yEnd - 100},\n            ${xEnd} ${yEnd - 10}\n            L ${xEnd} ${yEnd}`,\n        `${xEnd},${yEnd} ${xEnd - 5},${yEnd - 10} ${xEnd + 5},${yEnd - 10}`,\n      ];\n    } else if (activePosition.y < position.y) {\n      const xStart = activePosition.x + 150;\n      const yStart = activePosition.y + 80;\n\n      const xEnd = position.x + 150;\n      const yEnd = position.y;\n\n      return [\n        ` M ${xStart} ${yStart},\n              C ${xStart} ${yStart + 100},\n              ${xEnd} ${yEnd - 100},\n              ${xEnd} ${yEnd - 10}\n              L ${xEnd} ${yEnd}`,\n        `${xEnd},${yEnd} ${xEnd - 5},${yEnd - 10} ${xEnd + 5},${yEnd - 10}`,\n      ];\n    } else if (rel === \"ancesstor\") {\n      const xStart = position.x + 150;\n      const yStart = position.y;\n\n      const xEnd = activePosition.x + 150;\n      const yEnd = activePosition.y;\n\n      return [\n        ` M ${xStart} ${yStart},\n              C ${xStart} ${yStart - 80},\n              ${xEnd} ${yEnd - 80},\n              ${xEnd} ${yEnd - 10}\n              L ${xEnd} ${yEnd}`,\n        `${xEnd},${yEnd} ${xEnd - 5},${yEnd - 10} ${xEnd + 5},${yEnd - 10}`,\n      ];\n\n      // return [{ x: 0, y: 0 }, ``, ``];\n    } else {\n      const xStart = activePosition.x + 150;\n      const yStart = activePosition.y + 80;\n\n      const xEnd = position.x + 150;\n      const yEnd = position.y + 80;\n\n      return [\n        ` M ${xStart} ${yStart},\n              C ${xStart} ${yStart + 80},\n              ${xEnd} ${yEnd + 80},\n              ${xEnd} ${yEnd + 10}\n              L ${xEnd} ${yEnd}`,\n        `${xEnd},${yEnd} ${xEnd - 5},${yEnd + 10} ${xEnd + 5},${yEnd + 10}`,\n      ];\n    }\n  }, [position, activePosition, rel]);\n\n  return (\n    <TreeArrowsG>\n      <path\n        d={line}\n        strokeWidth=\"2\"\n        fill=\"transparent\"\n        stroke=\"rgba(0, 0, 0, 0.4)\"\n      ></path>\n      <polygon points={triangle} fill=\"black\" />\n    </TreeArrowsG>\n  );\n}\n\nexport default TreeArrows;\n","import TreeNode from \"./TreeNode\";\nimport { useCallback, useContext, useMemo } from \"react\";\nimport { TreeContext } from \"./TreeContext\";\nimport { useSelector } from \"react-redux\";\nimport { getItems } from \"../../redux/dependancies/dependanciesSlice\";\nimport TreeArrows from \"./TreeArrows\";\nimport { useHistory } from \"react-router\";\n\nfunction TreeContents() {\n  const { nodes, active } = useContext(TreeContext);\n  const items = useSelector(getItems);\n  const history = useHistory();\n\n  const activePosition = useMemo(() => {\n    return nodes[active].position;\n  }, [nodes, active]);\n\n  const switchItem = useCallback(\n    (id) => {\n      history.push(`/tree/${id}`);\n    },\n    [history]\n  );\n\n  return (\n    <>\n      {nodes && (\n        <>\n          {nodes.map((node, index) => {\n            if (node.rel === \"root\") {\n              return null;\n            }\n            return (\n              <TreeArrows\n                key={index}\n                rel={node.rel}\n                position={node.position}\n                activePosition={activePosition}\n              />\n            );\n          })}\n          {nodes.map((node, index) => (\n            <TreeNode\n              selected={() => {\n                switchItem(node.id);\n              }}\n              key={index}\n              itemDetails={items[node.id]}\n              {...node}\n            />\n          ))}\n        </>\n      )}\n    </>\n  );\n}\n\nexport default TreeContents;\n","import { useEffect, useState } from \"react\";\nimport DraggableGroup from \"./DraggableGroup\";\nimport styled from \"styled-components\";\n\nimport useViewport from \"../../hooks/useViewport\";\n\nimport TreeActions from \"./TreeActions\";\nimport TreeContents from \"./TreeContents\";\nimport { TreeContextProvider } from \"./TreeContext\";\n\nconst TreeViewWrap = styled.div`\n  width: calc(100vw - 320px);\n  height: 100vh;\n  position: relative;\n`;\n\nconst TreeViewSVG = styled.svg`\n  position: absolute;\n  left: 0;\n  top: 0;\n`;\n\nfunction TreeView() {\n  const viewport = useViewport();\n  const [svgProps, setSvgProps] = useState({\n    height: 300,\n    width: 600,\n    viewbox: `0 0 600 300`,\n  });\n\n  useEffect(() => {\n    const { width, height } = viewport;\n    setSvgProps({\n      width: width - 320,\n      height,\n      viewbox: `0 0 ${width - 320} ${height}`,\n    });\n  }, [viewport, setSvgProps]);\n\n  return (\n    <TreeViewWrap>\n      <TreeContextProvider>\n        <TreeViewSVG\n          preserveAspectRatio=\"none\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n          {...svgProps}\n        >\n          <DraggableGroup>\n            <TreeContents />\n          </DraggableGroup>\n        </TreeViewSVG>\n        <TreeActions/>\n      </TreeContextProvider>\n    </TreeViewWrap>\n  );\n}\nexport default TreeView;\n","import { createContext, useState, useCallback } from \"react\";\n\nexport const ClickAndDrag = createContext();\n\nexport const ClickAndDragProvider = ({ children }) => {\n  const [state, setState] = useState(false);\n\n  const drag = useCallback(() => {\n    setState(true);\n  }, [setState]);\n\n  const drop = useCallback(() => {\n    setState(false);\n  }, [setState]);\n\n  return (\n    <ClickAndDrag.Provider\n      value={{\n        linking: state,\n        drag,\n        drop,\n      }}\n    >\n      {children}\n    </ClickAndDrag.Provider>\n  );\n};\n","import { createContext, useCallback, useReducer } from \"react\";\n\nexport const Refs = createContext({});\n\nfunction reducer(state, { type, payload }) {\n  switch (type) {\n    case \"ADD\": {\n      const { id, ref } = payload;\n      return {\n        ...state,\n        [id]: ref,\n      };\n    }\n    case \"REMOVE\": {\n      const { id } = payload;\n      const newState = { ...state };\n      delete newState[id];\n      return newState;\n    }\n    default:\n      return state;\n  }\n}\n\nexport const RefsProvider = ({ children }) => {\n  const [state, dispatch] = useReducer(reducer, {});\n\n  const addRef = useCallback(\n    (id, ref) => {\n      dispatch({ type: \"ADD\", payload: { id, ref } });\n    },\n    [dispatch]\n  );\n\n  const removeRef = useCallback(\n    (id) => {\n      dispatch({ type: \"REMOVE\", payload: { id } });\n    },\n    [dispatch]\n  );\n\n  return (\n    <Refs.Provider\n      value={{\n        refs: state,\n        addRef,\n        removeRef,\n      }}\n    >\n      {children}\n    </Refs.Provider>\n  );\n};\n","import { createSlice } from \"@reduxjs/toolkit\";\n\nexport const connectionsSlice = createSlice({\n  name: \"connections\",\n  initialState: {\n    scrollLeft: 0,\n  },\n  reducers: {\n    updateScrollLeft: (state, action) => {\n      const { value } = action.payload;\n      state.scrollLeft = value;\n    },\n  },\n});\n\nexport const {\n    updateScrollLeft,\n} = connectionsSlice.actions;\n\nexport const getScrollLeft = (state) => state?.connections?.scrollLeft;\n\nexport default connectionsSlice.reducer;\n","import { createSlice } from \"@reduxjs/toolkit\";\n\nexport const linkingSlice = createSlice({\n  name: \"linking\",\n  initialState: {\n    source: false,\n  },\n  reducers: {\n    startLinking: (state, action) => {\n      state.source = action.payload.id;\n    },\n    doneLinking: (state) => {\n      state.source = false;\n    },\n  },\n});\n\nexport const { startLinking, doneLinking } = linkingSlice.actions;\n\nexport const getLinkingSource = (state) => state?.linking?.source;\nexport const getIsLinking = (state) => !!state?.linking?.source;\n\nexport default linkingSlice.reducer;\n","import { useMemo, useContext, useEffect, useRef, useState } from \"react\";\nimport { Refs } from \"../../context/refs\";\n\nimport useViewport from \"../../hooks/useViewport\";\n\nimport { useSelector } from \"react-redux\";\nimport { getConnections } from \"../../redux/dependancies/dependanciesSlice\";\nimport styled from \"styled-components\";\nimport { getScrollLeft } from \"../../redux/connections/connectionsSlice\";\nimport { getShowAllArrows } from \"../../redux/options/optionsSlice\";\nimport { getLinkingSource } from \"../../redux/linking/linkingSlice\";\n\nconst ConnectionsWrap = styled.div`\n  pointer-events: none;\n  position: absolute;\n  bottom: 0;\n  right: 0;\n  left: 0;\n  top: 0;\n`;\n\nconst Svg = styled.svg`\n  width: 100%;\n  height: 100%;\n  display: block;\n`;\n\nfunction Connections() {\n  const connections = useSelector(getConnections);\n  const scrollLeft = useSelector(getScrollLeft);\n\n  const showAllArrows = useSelector(getShowAllArrows);\n  const linkingSource = useSelector(getLinkingSource);\n\n  const refsContext = useContext(Refs);\n\n  const [svgProps, setSvgProps] = useState({\n    width: 100,\n    height: 100,\n    viewBox: `0 0 100 100`,\n  });\n\n  const viewport = useViewport();\n\n  const ref = useRef(null);\n\n  const lines = useMemo(() => {\n    const { scrollTop } = document.documentElement;\n\n    if (!connections) {\n      return null;\n    }\n\n    const filterMethod = showAllArrows\n      ? () => true\n      : ({ from, to }) => from === linkingSource || to === linkingSource;\n\n    return connections\n      ?.filter(filterMethod)\n      ?.map(({ from, to }) => {\n        try {\n          const fromRef = refsContext.refs[from];\n          const toRef = refsContext.refs[to];\n\n          const fromClientRect = fromRef.getBoundingClientRect();\n          const xStart = fromClientRect.right - 320;\n          const yStart =\n            fromClientRect.top + scrollTop + fromClientRect.height / 2;\n\n          const toClientRect = toRef.getBoundingClientRect();\n          let xEnd = toClientRect.right - 320;\n          let yEnd = toClientRect.top + scrollTop + toClientRect.height / 2;\n\n          if (xStart === xEnd || Math.abs(xStart - xEnd) < 1) {\n            // modifier is negative if to is below from\n            const modifier = yStart > yEnd ? 1 : -1;\n            yEnd = yEnd + (modifier * toClientRect.height) / 4;\n\n            return {\n              line: `M ${xStart} ${yStart} \n          C ${xStart + 40} ${yStart}, \n            ${xEnd + 40} ${yEnd}, \n            ${xEnd} ${yEnd}`,\n              start: { x: xStart, y: yStart },\n            };\n          } else {\n            xEnd = toClientRect.left - 320;\n\n            return {\n              line: `M ${xStart} ${yStart} \n            C ${xStart + 40} ${yStart}, \n              ${xEnd - 40} ${yEnd}, \n              ${xEnd} ${yEnd}`,\n              start: { x: xStart, y: yStart },\n            };\n          }\n\n          // return `M ${x1} ${y1} , L ${x2}, ${y2}`;\n          // return `M ${x1} ${y1} C ${x1} ${y1}, ${x1 + 20} ${y1}, ${x2} ${y2}`;\n\n          // return `M ${xStart} ${yStart} C ${xStart} ${yStart}, ${xStart + 50} ${\n          //   yStart + 50\n          // }, ${xEnd} ${yEnd}`;\n        } catch (err) {\n          console.log(err);\n        }\n        return null;\n      })\n      ?.filter((line) => !!line)\n      .map(({ start, line }, index) => {\n        return (\n          <g key={index}>\n            <path\n              d={line}\n              strokeWidth=\"2\"\n              fill=\"transparent\"\n              stroke=\"rgba(0, 0, 0, 0.4)\"\n            ></path>\n            <circle cx={start.x} cy={start.y} r=\"4\" fill=\"rgb(0, 0, 0)\" />\n          </g>\n        );\n      });\n  }, [\n    viewport,\n    scrollLeft,\n    connections,\n    refsContext,\n    linkingSource,\n    showAllArrows,\n  ]);\n\n  useEffect(() => {\n    if (!viewport || !ref?.current) {\n      return;\n    }\n    setSvgProps({\n      height: viewport.height,\n      width: viewport.width,\n      viewBox: `0 0 ${viewport.height} ${viewport.width}`,\n    });\n  }, [viewport, ref, setSvgProps]);\n\n  return (\n    <ConnectionsWrap ref={ref}>\n      <Svg\n        preserveAspectRatio=\"none\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n        height={svgProps.height}\n        width={svgProps.width}\n        viewbox={svgProps.viewBox}\n      >\n        {lines}\n      </Svg>\n    </ConnectionsWrap>\n  );\n}\n\nexport default Connections;\n","import { useEffect, useCallback, useState, useReducer } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport styled from \"styled-components\";\n\nimport statuses from \"../../data/statuses\";\n\nimport Button from \"carbon-react/lib/components/button\";\nimport Textbox from \"carbon-react/lib/__experimental__/components/textbox\";\nimport Typography from \"carbon-react/lib/components/typography\";\nimport Confirm from \"carbon-react/lib/components/confirm\";\nimport { Select, Option } from \"carbon-react/lib/components/select\";\n\nimport { updateItem } from \"../../redux/dependancies/dependanciesSlice\";\n\nimport { removeItem } from \"../../redux/dependancies/dependanciesSlice\";\n\nconst ItemButtons = styled.div`\n  display: flex;\n  justify-content: flex-end;\n  gap: 1rem;\n`;\n\nconst Circle = styled.span`\n  display: inline-block;\n  width: 12px;\n  height: 12px;\n  border-radius: 50%;\n  margin: 0 0.5rem;\n  vertical-align: middle;\n  ${(props) => props.color && `background: ${props.color};`}\n`;\n\nconst formDataReducer = (state, action) => {\n  switch (action.type) {\n    case \"SET\":\n      return action.payload;\n    case \"UPDATE\":\n      const { key, val } = action.payload;\n      return { ...state, [key]: val };\n    default:\n      return state;\n  }\n};\n\nfunction NodeEditor({ itemId, item, doneEditing }) {\n  const dispatch = useDispatch();\n  const [confirmDelete, setConfirmDelete] = useState(false);\n\n  const [formData, formDataDispatch] = useReducer(formDataReducer, {\n    title: \"\",\n    status: \"\",\n    description: \"\",\n  });\n\n  const save = useCallback(() => {\n    const now = new Date();\n    dispatch({\n      type: updateItem.type,\n      payload: {\n        id: itemId,\n        update: {\n          ...formData,\n          updated: {\n            seconds: Math.floor(now / 1000),\n            milliseconds: now % 1000,\n          },\n        },\n      },\n    });\n    doneEditing();\n  }, [itemId, dispatch, formData, doneEditing]);\n\n  useEffect(() => {\n    formDataDispatch({ type: \"SET\", payload: item });\n  }, [item]);\n\n  return (\n    <form\n      onSubmit={(ev) => {\n        ev.preventDefault();\n      }}\n    >\n      <Typography>\n        <Textbox\n          labelInline\n          label=\"Name\"\n          size=\"small\"\n          value={formData.title}\n          onChange={(ev) => {\n            formDataDispatch({\n              type: \"UPDATE\",\n              payload: {\n                key: \"title\",\n                val: ev.target.value,\n              },\n            });\n          }}\n          required\n        />\n      </Typography>\n      <Typography>\n        <Select\n          labelInline\n          name=\"simple\"\n          size=\"small\"\n          label=\"Status\"\n          value={formData.status}\n          onChange={(ev) => {\n            formDataDispatch({\n              type: \"UPDATE\",\n              payload: {\n                key: \"status\",\n                val: ev.target.value,\n              },\n            });\n          }}\n        >\n          {Object.keys(statuses).map((status) => {\n            return (\n              <Option value={status} key={status}>\n                <Circle color={statuses[status].color} />\n                {statuses[status].text}\n              </Option>\n            );\n          })}\n        </Select>\n      </Typography>\n      <Typography>\n        <Textbox\n          labelInline\n          label=\"Description\"\n          value={formData.description}\n          size=\"small\"\n          onChange={(ev) => {\n            formDataDispatch({\n              type: \"UPDATE\",\n              payload: {\n                key: \"description\",\n                val: ev.target.value,\n              },\n            });\n          }}\n        />\n      </Typography>\n      <ItemButtons>\n        <Button size=\"small\" onClick={setConfirmDelete}>\n          Delete\n        </Button>\n\n        <Button buttonType=\"primary\" size=\"small\" onClick={save} type=\"submit\">\n          Done\n        </Button>\n      </ItemButtons>\n\n      <Confirm\n        title=\"Delete item\"\n        open={confirmDelete}\n        onConfirm={() => {\n          setConfirmDelete(false);\n          requestAnimationFrame(() => {\n            dispatch({ type: removeItem.type, payload: { id: itemId } });\n          });\n        }}\n        onCancel={() => setConfirmDelete(false)}\n      >\n        Are you sure?\n      </Confirm>\n    </form>\n  );\n}\n\nexport default NodeEditor;\n","import { useMemo } from \"react\";\nimport styled from \"styled-components\";\nimport { useSelector } from \"react-redux\";\nimport { getUserDetails } from \"../../redux/user/userSlice\";\nimport Button from \"carbon-react/lib/components/button\";\n\nconst ButtonWrap = styled.div`\n  display: none;\n  position: absolute;\n  right: 0;\n  bottom: 0;\n`;\n\nconst CommentMeta = styled.div`\n  margin-bottom: 0.7rem;\n  display: flex;\n  gap: 0.5rem;\n`;\nconst CommentContent = styled.div`\n  font-size: 16px;\n  background: rgba(0, 0, 0, 0.1);\n  padding: 1rem;\n  position: relative;\n  &::before {\n    content: \"\";\n    display: block;\n    position: absolute;\n    left: 0;\n    bottom: 100%;\n    border-right: 0.6rem solid transparent;\n    border-bottom: 0.6rem solid rgba(0, 0, 0, 0.1);\n  }\n`;\n\nconst CommentAuthor = styled.div`\n  font-weight: 600;\n`;\n\nconst CommentWrap = styled.div`\n  margin-bottom: 1rem;\n  width: 66%;\n  ${(props) => props.align === \"right\" && \"margin-left: auto;\"}\n  .date {\n    opacity: 0;\n  }\n  &:hover {\n    .date {\n      opacity: 1;\n    }\n  }\n  ${(props) =>\n    props.align === \"right\" &&\n    `${CommentMeta} {\n      flex-direction: row-reverse;\n    }\n    ${CommentContent}::before {\n      right: 0;\n      left: auto;\n      border-left: 0.6rem solid transparent;\n      border-right: none;\n    }\n    `}\n  &:focus-within ${ButtonWrap} {\n    display: block;\n  }\n`;\n\nfunction SingleComment({ comment, deleteComment }) {\n  const userDetails = useSelector(getUserDetails);\n\n  const dateFormatted = useMemo(\n    () =>\n      comment?.datetime?.seconds\n        ? new Date(comment.datetime.seconds * 1000).toLocaleString({\n            weekday: \"long\",\n            year: \"numeric\",\n            month: \"long\",\n          })\n        : null,\n    [comment.datetime]\n  );\n\n  const fromSelf = userDetails?.email === comment.author;\n\n  return (\n    <CommentWrap align={fromSelf ? \"right\" : \"left\"}>\n      <CommentMeta>\n        <CommentAuthor>{fromSelf ? \"You\" : comment.author}</CommentAuthor>\n        {dateFormatted && <div className=\"date\">{dateFormatted}</div>}\n      </CommentMeta>\n      <CommentContent tabIndex=\"0\">\n        {comment?.content}\n        {fromSelf && (\n          <ButtonWrap>\n            <Button\n              size=\"small\"\n              buttonType=\"tertiary\"\n              onClick={deleteComment}\n              type=\"button\"\n              destructive\n            >\n              Delete?\n            </Button>\n          </ButtonWrap>\n        )}\n      </CommentContent>\n    </CommentWrap>\n  );\n}\nexport default SingleComment;\n","import styled from \"styled-components\";\n\nimport SingleComment from \"./SingleComment\";\n\nconst CommentHistoryBox = styled.div`\n  min-height: 100px;\n  max-height: 400px;\n  overflow-y: auto;\n  border: 1px solid;\n  display: flex;\n  flex-direction: column;\n  padding: .5rem 2rem;\n`;\n\nconst NoComments = styled.div`\n  margin: auto;\n`;\n\nfunction CommentHistory({ comments = [], deleteComment }) {\n  return (\n    <CommentHistoryBox>\n      {comments.length === 0 && <NoComments>No comments</NoComments>}\n      {comments.map((comment) => (\n        <SingleComment key={comment.key} comment={comment} deleteComment={() => deleteComment(comment.key)}/>\n      ))}\n    </CommentHistoryBox>\n  );\n}\n\nexport default CommentHistory;\n","import styled from \"styled-components\";\n\nimport Textarea from \"carbon-react/lib/__experimental__/components/textarea\";\nimport Button from \"carbon-react/lib/components/button\";\nimport { useState } from \"react\";\n\nconst Actions = styled.div`\n  margin-top: 1rem;\n  display: flex;\n  justify-content: flex-start;\n  flex-direction: row-reverse;\n`;\n\nconst Form = styled.form`\n  display: block;\n  margin-top: 2rem;\n`;\n\nfunction NewComment({ onSubmit, onCancel }) {\n  const [message, setMessage] = useState(\"\");\n  const handleSubmit = (ev) => {\n    ev.preventDefault();\n    onSubmit(message.trim());\n    setMessage(\"\");\n  };\n  return (\n    <Form onSubmit={handleSubmit}>\n      <Textarea\n        label=\"Add a comment\"\n        required\n        rows={2}\n        value={message}\n        onChange={(ev) => setMessage(ev.target.value)}\n      />\n      <Actions>\n        <Button buttonType=\"primary\" ml={2} type=\"submit\">\n          Send\n        </Button>\n        <Button buttonType=\"secondary\" type=\"reset\" onClick={onCancel}>\n          Cancel\n        </Button>\n      </Actions>\n    </Form>\n  );\n}\n\nexport default NewComment;\n","import { useCallback, useMemo, useEffect } from \"react\";\n\nimport Dialog from \"carbon-react/lib/components/dialog\";\nimport Loader from \"carbon-react/lib/components/loader\";\n\nimport { useFirestore, useFirestoreCollectionData } from \"reactfire\";\n\nimport CommentHistory from \"./CommentHistory\";\nimport NewComment from \"./NewComment\";\nimport { useSelector } from \"react-redux\";\nimport { getUserDetails } from \"../../redux/user/userSlice\";\n\nfunction Comments({ name, itemId, close }) {\n  const firestore = useFirestore();\n\n  const itemRef = useMemo(() => firestore.collection(\"items\").doc(itemId), [\n    itemId,\n    firestore,\n  ]);\n\n  const messagesRef = useMemo(() => itemRef.collection(\"messages\"), [itemRef]);\n\n  const userDetails = useSelector(getUserDetails);\n\n  const threadMessages = useFirestoreCollectionData(messagesRef, {\n    idField: \"key\",\n  });\n\n  const comments = useMemo(\n    () =>\n      (threadMessages?.data || []).sort((a, b) => {\n        try {\n          const Ta = a.datetime.seconds * 1000 + a.datetime.milliseconds;\n          const Tb = b.datetime.seconds * 1000 + b.datetime.milliseconds;\n          if (Ta < Tb) {\n            return -1;\n          }\n          if (Ta > Tb) {\n            return 1;\n          }\n        } catch (err) {}\n        // a must be equal to b\n        return 0;\n      }),\n    [threadMessages]\n  );\n\n  const addComment = useCallback(\n    (comment) => {\n      const now = Date.now();\n      itemRef.update({\n        messageCount: threadMessages.data.length + 1,\n      });\n      messagesRef.add({\n        author: userDetails.email,\n        content: comment,\n        datetime: {\n          seconds: Math.floor(now / 1000),\n          milliseconds: now % 1000,\n        },\n      });\n    },\n    [userDetails, itemRef, messagesRef, threadMessages]\n  );\n\n  const deleteComment = useCallback(\n    (id) => {\n      console.log(id);\n      messagesRef.doc(id).delete();\n    },\n    [messagesRef]\n  );\n\n  useEffect(() => {\n    console.log({ itemId, comments });\n  }, [comments, itemId]);\n\n  return (\n    <>\n      <Dialog\n        open={true}\n        onCancel={() => close()}\n        title={`Comments ${name}`}\n        size=\"medium\"\n      >\n        {threadMessages.status === \"loading\" ? (\n          <div>\n            <Loader size=\"large\" />\n          </div>\n        ) : (\n          <>\n            <CommentHistory\n              comments={comments}\n              deleteComment={(id) => deleteComment(id)}\n            />\n            <NewComment\n              onSubmit={(message) => {\n                console.log({ message });\n                addComment(message);\n              }}\n              onCancel={close}\n            />\n          </>\n        )}\n      </Dialog>\n    </>\n  );\n}\n\nexport default Comments;\n","import {\n  useContext,\n  useCallback,\n  useRef,\n  useState,\n  useMemo,\n  useEffect,\n} from \"react\";\nimport { useHistory } from \"react-router\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport styled from \"styled-components\";\n\nimport Button from \"carbon-react/lib/components/button\";\nimport Content from \"carbon-react/lib/components/content\";\nimport Icon from \"carbon-react/lib/components/icon\";\nimport IconButton from \"carbon-react/lib/components/icon-button\";\nimport Tile from \"carbon-react/lib/components/tile\";\nimport Pill from \"carbon-react/lib/components/pill\";\nimport Typography from \"carbon-react/lib/components/typography\";\n\nimport { Refs } from \"../../context/refs\";\n\nimport {\n  getItems,\n  addConnection,\n} from \"../../redux/dependancies/dependanciesSlice\";\n\nimport { getCommentAccess, getReadOnly } from \"../../redux/user/userSlice\";\n\nimport {\n  startLinking,\n  doneLinking,\n  getIsLinking,\n  getLinkingSource,\n} from \"../../redux/linking/linkingSlice\";\n\nimport NodeEditor from \"./NodeEditor\";\n\nimport statuses from \"../../data/statuses\";\nimport Comments from \"../Comments/Comments\";\n\nconst CommentBtnWrap = styled.div`\n  position: absolute;\n  right: 0;\n  top: 0;\n`;\n\nconst ColumnItemEle = styled.div`\n  position: relative;\n  margin-bottom: 1.5rem;\n  ${(props) =>\n    props.linking\n      ? `\n      cursor:pointer;\n      &:hover {\n        border-color: red;\n      }`\n      : \"\"}\n`;\n\nconst ItemButtons = styled.div`\n  display: flex;\n  justify-content: flex-end;\n  gap: 0.5rem;\n`;\n\nconst ReadOnlyView = styled.div`\n  position: relative;\n  padding-left: 1rem;\n`;\n\nfunction ColumnItem({ itemId }) {\n  const ref = useRef(null);\n\n  const [edittable, setEdittable] = useState(false);\n\n  const [showComments, setShowComments] = useState(false);\n\n  const dispatch = useDispatch();\n  const history = useHistory();\n\n  const items = useSelector(getItems);\n  const linkingSource = useSelector(getLinkingSource);\n  const linking = useSelector(getIsLinking);\n\n  const readonly = useSelector(getReadOnly);\n  const commentAccess = useSelector(getCommentAccess);\n\n  const { addRef, removeRef } = useContext(Refs);\n\n  const item = useMemo(() => {\n    return items[itemId];\n  }, [items, itemId]);\n\n  const startEditing = useCallback(\n    (ev) => {\n      ev.preventDefault();\n      setEdittable(true);\n      requestAnimationFrame(() => {\n        ref.current?.querySelector(\"input\")?.focus();\n      });\n    },\n    [setEdittable, ref]\n  );\n\n  const doneEditing = useCallback(() => {\n    setEdittable(false);\n  }, [setEdittable]);\n\n  const viewTree = useCallback(\n    (ev) => {\n      ev.preventDefault();\n      history.push(`/tree/${itemId}`);\n    },\n    [history, itemId]\n  );\n\n  // Add a link\n  const addLink = useCallback(() => {\n    if (linking && linkingSource !== itemId) {\n      dispatch({\n        type: addConnection.type,\n        payload: { from: linkingSource, to: itemId },\n      });\n    }\n  }, [linking, linkingSource, dispatch, itemId]);\n\n  // Start linking\n  const startLinkingFromNode = useCallback(\n    (ev) => {\n      ev.preventDefault();\n      dispatch({\n        type: startLinking.type,\n        payload: { id: itemId },\n      });\n    },\n    [dispatch, itemId]\n  );\n\n  useEffect(() => {\n    addRef(itemId, ref.current);\n    return () => {\n      removeRef(itemId);\n    };\n  }, [addRef, removeRef, ref, itemId]);\n\n  useEffect(() => {\n    if (linking !== itemId) {\n      return;\n    }\n    const exitlinking = (ev) => {\n      if (ev.key === \"Escape\") {\n        dispatch({ type: doneLinking.type });\n      }\n    };\n    window.addEventListener(\"keydown\", exitlinking);\n    return () => {\n      window.removeEventListener(\"keydown\", exitlinking);\n    };\n  }, [itemId, linking, dispatch]);\n\n  return (\n    <ColumnItemEle ref={ref} onClick={addLink} linking={!!linking} id={itemId}>\n      <Tile orientation=\"vertical\" pixelWidth={320}>\n        <Content>\n          {edittable ? (\n            <NodeEditor {...{ itemId, item, doneEditing }} />\n          ) : (\n            <ReadOnlyView>\n              <div\n                style={{\n                  position: \"absolute\",\n                  right: \"100%\",\n                  top: \"50%\",\n                  transform: \"translate(.5rem, -50%)\",\n                  cursor: \"pointer\",\n                }}\n              >\n                <Icon fontSize=\"medium\" type=\"drag_vertical\" />\n              </div>\n\n              <Typography variant=\"h3\" mb={1}>\n                {item.title ?? \"\\u00A0\"}\n              </Typography>\n\n              {item.status && (\n                <Pill mb={1} borderColor={statuses[item.status]?.color} fill>\n                  {statuses[item.status]?.text}\n                </Pill>\n              )}\n\n              {item.description && (\n                <Typography mb={2}>{item.description}</Typography>\n              )}\n\n              <ItemButtons>\n                {linkingSource === itemId ? (\n                  <Button\n                    size=\"small\"\n                    variant=\"primary\"\n                    onClick={() => dispatch({ type: doneLinking.type })}\n                  >\n                    Done\n                  </Button>\n                ) : (\n                  <>\n                    {!readonly && (\n                      <>\n                        <Button\n                          size=\"small\"\n                          onClick={startEditing}\n                          disabled={!!linking}\n                        >\n                          Edit\n                        </Button>\n                        <Button\n                          size=\"small\"\n                          onClick={startLinkingFromNode}\n                          disabled={!!linking}\n                        >\n                          Link\n                        </Button>\n                      </>\n                    )}\n\n                    <Button\n                      size=\"small\"\n                      onClick={viewTree}\n                      disabled={!!linking}\n                    >\n                      View\n                    </Button>\n                  </>\n                )}\n              </ItemButtons>\n\n              {commentAccess && (\n                <CommentBtnWrap>\n                  <IconButton\n                    size=\"small\"\n                    onAction={() => setShowComments(true)}\n                  >\n                    <Icon type=\"talk\" />\n                  </IconButton>\n                </CommentBtnWrap>\n              )}\n            </ReadOnlyView>\n          )}\n        </Content>\n      </Tile>\n\n      {showComments && (\n        <Comments\n          name={item.title}\n          itemId={itemId}\n          close={() => {\n            setShowComments(false);\n          }}\n        />\n      )}\n    </ColumnItemEle>\n  );\n}\n\nexport default ColumnItem;\n","import { useMemo, useRef } from \"react\";\nimport IconButton from \"carbon-react/lib/components/icon-button\";\nimport Icon from \"carbon-react/lib/components/icon\";\nimport styled from \"styled-components\";\nimport { useSelector, useDispatch } from \"react-redux\";\n\nimport { getReadOnly } from \"../../redux/user/userSlice\";\n\nimport {\n  addItem,\n  getColumns,\n  updateColumn,\n} from \"../../redux/dependancies/dependanciesSlice\";\n\nimport ColumnItem from \"./ColumnItem\";\n\nconst ColumnEle = styled.div`\n  display: flex;\n  padding: 0 2.5rem;\n  flex: 0 0 320px;\n  flex-direction: column;\n  border-right: 2px solid #8099a4;\n`;\n\nconst ColumnVerticalList = styled.div`\n  display: flex;\n  flex-direction: column;\n  flex: 1 1 100%;\n  align-items: center;\n  ${(props) => props.justify && `justify-content: ${props.justify};`}\n`;\n\nconst ColumnTitle = styled.div`\n  position: sticky;\n  top: 0;\n  left: 0;\n  right: 0;\n  padding: 1.5rem 0;\n  display: flex;\n  gap: 1rem;\n`;\n\nconst ColumnTitleText = styled.h2`\n  font-size: 18px;\n  font-weight: 600;\n  padding: 0.5rem;\n  border-bottom: 2px solid transparent;\n  margin: 0;\n`;\n\nconst ColumnTitleEditable = styled.input`\n  border: none;\n  background: none;\n  font-family: inherit;\n  font-size: 18px;\n  font-weight: 600;\n  padding: 0.5rem;\n  border-radius: 0;\n  width: 100%;\n  border-bottom: 2px solid transparent;\n  box-sizing: border-box;\n  &:focus {\n    outline: none;\n    border-bottom: 2px solid #0077c8;\n  }\n`;\n\nconst EditableWrap = styled.div`\n  flex: 1 0 auto;\n  position: relative;\n`;\n\nconst EditableIcon = styled.div`\n  position: absolute;\n  right: 0;\n  top: 0.5rem;\n  cursor: pointer;\n`;\n\nfunction Column({ justify = \"flex-start\", colId }) {\n  const dispatch = useDispatch();\n  const columns = useSelector(getColumns);\n\n  const column = useMemo(() => columns[colId], [colId, columns]);\n  const readonly = useSelector(getReadOnly);\n  const titleInput = useRef(null);\n\n  return (\n    <ColumnEle>\n      <ColumnTitle>\n        {readonly ? (\n          <ColumnTitleText>{column?.title}</ColumnTitleText>\n        ) : (\n          <>\n            <EditableWrap>\n              <ColumnTitleEditable\n                ref={titleInput}\n                value={column?.title}\n                type=\"text\"\n                onChange={(ev) => {\n                  dispatch({\n                    type: updateColumn.type,\n                    payload: { id: colId, title: ev.target.value },\n                  });\n                }}\n              />\n              <EditableIcon\n                onClick={() => {\n                  titleInput.current.focus();\n                }}\n              >\n                <Icon type=\"edit\" />\n              </EditableIcon>\n            </EditableWrap>\n            <IconButton\n              type=\"button\"\n              onAction={(ev) => {\n                ev.preventDefault();\n                dispatch({\n                  type: addItem.type,\n                  payload: {\n                    column: colId,\n                  },\n                });\n              }}\n            >\n              <Icon bgTheme=\"info\" bgSize=\"large\" type=\"plus\" />\n            </IconButton>\n          </>\n        )}\n      </ColumnTitle>\n\n      <ColumnVerticalList justify={justify}>\n        {column?.items?.map((itemId) => (\n          <ColumnItem key={itemId} itemId={itemId} />\n        ))}\n      </ColumnVerticalList>\n    </ColumnEle>\n  );\n}\n\nexport default Column;\n","import { useCallback, useRef } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport styled from \"styled-components\";\nimport { ClickAndDragProvider } from \"../../context/clickAndDrag\";\nimport { RefsProvider } from \"../../context/refs\";\nimport { getColumns } from \"../../redux/dependancies/dependanciesSlice\";\n\nimport Connections from \"./Connections\";\nimport Column from \"./Column\";\nimport { updateScrollLeft } from \"../../redux/connections/connectionsSlice\";\n\nconst ColumnsViewWrap = styled.div`\n  min-height: 100vh;\n  display: flex;\n  flex-direction: column;\n  align-items: stretch;\n  position: relative;\n`;\nconst ColumnsScrollableWrap = styled.div`\n  width: 100%;\n  display: flex;\n  flex: 1 1 100%;\n  overflow-x: scroll;\n  scroll-behaviour: smooth;\n`;\n\nconst Provders = ({ children }) => (\n  <ClickAndDragProvider>\n    <RefsProvider>{children}</RefsProvider>\n  </ClickAndDragProvider>\n);\n\nfunction ColumnsView() {\n  const columns = useSelector(getColumns);\n  const dispatch = useDispatch();\n\n  const scrollable = useRef(null);\n\n  const handleScroll = useCallback(\n    (ev) => {\n      dispatch({\n        type: updateScrollLeft.type,\n        payload: { value: ev.target.scrollLeft },\n      });\n    },\n    [dispatch]\n  );\n\n  return (\n    <Provders>\n      <Connections />\n      <ColumnsViewWrap>\n        <ColumnsScrollableWrap ref={scrollable} onScroll={handleScroll}>\n          {Object.keys(columns).map((colId) => (\n            <Column key={colId} colId={colId} />\n          ))}\n        </ColumnsScrollableWrap>\n      </ColumnsViewWrap>\n    </Provders>\n  );\n}\nexport default ColumnsView;\n","import firebase from \"firebase\";\nimport Button from \"carbon-react/lib/components/button\";\nimport Profile from \"carbon-react/lib/components/profile\";\n\nimport { useDispatch, useSelector } from \"react-redux\";\nimport styled from \"styled-components\";\nimport {\n  getUserDetails,\n  logOut,\n  getNoSignIn,\n  setNoSignIn,\n} from \"../redux/user/userSlice\";\n\nconst UserDetailsWrap = styled.div`\n  margin: 2rem auto;\n  padding: 0 2rem;\n`;\n\nfunction UserDetails() {\n  const dispatch = useDispatch();\n  const userDetails = useSelector(getUserDetails);\n  const noSignIn = useSelector(getNoSignIn);\n  return (\n    <UserDetailsWrap>\n      {noSignIn ? (\n        <>\n          <Button\n            mt={1}\n            fullWidth\n            buttonType=\"primary\"\n            onClick={() => {\n              console.log('Sign in!');\n              dispatch({ type: setNoSignIn.type, payload: false });\n            }}\n            >Click here to sign in</Button>\n        </>\n      ) : (\n        <>\n          <Profile\n            size=\"ML\"\n            email={userDetails.email}\n            src={userDetails.photoURL}\n            name={userDetails.displayName}\n          />\n          <Button\n            mt={2}\n            size=\"small\"\n            onClick={() => {\n              firebase\n                .auth()\n                .signOut()\n                .then(() => {\n                  dispatch({ type: logOut.type });\n                });\n            }}\n          >\n            Log out\n          </Button>\n        </>\n      )}\n    </UserDetailsWrap>\n  );\n}\nexport default UserDetails;\n","import Button from \"carbon-react/lib/components/button\";\nimport Typography from \"carbon-react/lib/components/typography\";\nimport { useCallback } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { useHistory } from \"react-router\";\nimport styled from \"styled-components\";\n\nimport { getItems } from \"../redux/dependancies/dependanciesSlice\";\n\nconst ItemActions = styled.div`\n  display: flex;\n  gap: 0.5rem;\n  justify-content: flex-end;\n`;\n\nconst ItemList = styled.ul`\n  max-height: 400px;\n  overflow-y: auto;\n  list-style: none;\n  padding: 0;\n`;\n\nconst Item = styled.li`\n  padding: 0.5rem;\n  border: 1px solid #ccd6db;\n  margin-bottom: 1rem;\n`;\n\nfunction SearchResults({ searchTerm }) {\n  const history = useHistory();\n  const searchSelector = useCallback(\n    (state) => {\n      if (!searchTerm) {\n        return [];\n      }\n      const items = getItems(state);\n      if (!items) {\n        return [];\n      }\n      return Object.keys(items)\n        .map((itemId) => ({\n          ...items[itemId],\n          id: itemId,\n        }))\n        .filter(\n          (item) =>\n            item.title.toLowerCase().includes(searchTerm.toLowerCase()) ||\n            item.description.toLowerCase().includes(searchTerm.toLowerCase())\n        );\n    },\n    [searchTerm]\n  );\n  const results = useSelector((state) => searchSelector(state, searchTerm));\n  return (\n    <div>\n      <ItemList>\n        {results.map((item) => {\n          return (\n            <Item key={item.id} as=\"li\" listStyleType=\"none\" pl={0}>\n              <Typography fontWeight=\"700\" mb={2}>\n                {item.title}\n              </Typography>\n              <ItemActions>\n                <Button\n                  size=\"small\"\n                  onClick={() => {\n                    history.push(`/tree/${item.id}`);\n                  }}\n                >\n                  View\n                </Button>\n              </ItemActions>\n            </Item>\n          );\n        })}\n      </ItemList>\n    </div>\n  );\n}\n\nexport default SearchResults;\n","import { useState } from \"react\";\n\nimport Search from \"carbon-react/lib/__experimental__/components/search\";\nimport SearchResults from \"./SearchResults\";\nimport styled from \"styled-components\";\nimport Typography from \"carbon-react/lib/components/typography\";\n\nconst SearchWrap = styled.form`\n  margin: 2rem 0;\n  padding: 0 2rem;\n`;\n\nconst SearchLabel = styled.label`\n  display: block;\n  margin: 0 0 2rem;\n`;\n\nfunction ComponentSearch() {\n  const [searchTerm, setSearchTerm] = useState(\"\");\n\n  return (\n    <SearchWrap onSubmit={(ev) => ev.preventDefault()}>\n      <SearchLabel>\n        <Typography as=\"div\" fontWeight=\"700\" mb={1}>Search</Typography>\n        <Search\n          id=\"search\"\n          name=\"search\"\n          placeholder=\"\"\n          onChange={(e) => setSearchTerm(e.target.value)}\n          value={searchTerm}\n          searchButton\n        />\n      </SearchLabel>\n      <SearchResults searchTerm={searchTerm} />\n    </SearchWrap>\n  );\n}\n\nexport default ComponentSearch;\n","import ButtonToggle from \"carbon-react/lib/components/button-toggle\";\nimport Typography from \"carbon-react/lib/components/typography\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport styled from \"styled-components\";\nimport { getShowAllArrows, setOption } from \"../redux/options/optionsSlice\";\n\nconst Wrap = styled.div`\n  text-align: center;\n`;\n\nfunction ShowHideAllArrows() {\n  const showAllArrows = useSelector(getShowAllArrows);\n  const dispatch = useDispatch();\n  return (\n    <Wrap>\n      <Typography fontWeight=\"600\" mb={1}>\n        Show all arrows:\n      </Typography>\n      <div>\n        <ButtonToggle\n          grouped\n          name=\"showOtherRels\"\n          key=\"show\"\n          onChange={() => {\n            dispatch({\n              type: setOption.type,\n              payload: { key: \"showAllArrows\", value: true },\n            });\n          }}\n          checked={showAllArrows}\n        >\n          Show\n        </ButtonToggle>\n        <ButtonToggle\n          grouped\n          name=\"showOtherRels\"\n          key=\"hide\"\n          onChange={() => {\n            dispatch({\n              type: setOption.type,\n              payload: { key: \"showAllArrows\", value: false },\n            });\n          }}\n          checked={!showAllArrows}\n        >\n          Hide\n        </ButtonToggle>\n      </div>\n    </Wrap>\n  );\n}\n\nexport default ShowHideAllArrows;\n","import ButtonToggle from \"carbon-react/lib/components/button-toggle\";\nimport Typography from \"carbon-react/lib/components/typography\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport styled from \"styled-components\";\nimport {\n  getShowOtherRelations,\n  setOption,\n} from \"../redux/options/optionsSlice\";\n\nconst Wrap = styled.div`\n  text-align: center;\n`;\n\nfunction ShowHideOtherRelations() {\n  const showOtherRelations = useSelector(getShowOtherRelations);\n  const dispatch = useDispatch();\n  return (\n    <Wrap>\n      <Typography fontWeight=\"600\" mb={1}>\n        Show other relations:\n      </Typography>\n      <div>\n        <ButtonToggle\n          grouped\n          name=\"showOtherRels\"\n          key=\"show\"\n          onChange={() => {\n            dispatch({\n              type: setOption.type,\n              payload: { key: \"showOtherRelations\", value: true },\n            });\n          }}\n          checked={showOtherRelations}\n        >\n          Show\n        </ButtonToggle>\n        <ButtonToggle\n          grouped\n          name=\"showOtherRels\"\n          key=\"hide\"\n          onChange={() => {\n            dispatch({\n              type: setOption.type,\n              payload: { key: \"showOtherRelations\", value: false },\n            });\n          }}\n          checked={!showOtherRelations}\n        >\n          Hide\n        </ButtonToggle>\n      </div>\n    </Wrap>\n  );\n}\n\nexport default ShowHideOtherRelations;\n","import Loader from \"carbon-react/lib/components/loader\";\nimport Button from \"carbon-react/lib/components/button\";\nimport { useCallback } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { getSaving, save } from \"../redux/dependancies/dependanciesSlice\";\nimport { getWriteAccess } from \"../redux/user/userSlice\";\n\nfunction SaveButton() {\n  const writeAccess = useSelector(getWriteAccess);\n  const saving = useSelector(getSaving);\n  const dispatch = useDispatch();\n\n  const handleClick = useCallback(\n    (ev) => {\n      ev.preventDefault();\n      if (!saving) {\n        dispatch({ type: save.type });\n      }\n    },\n    [dispatch, saving]\n  );\n\n  if (!writeAccess) {\n    return null;\n  }\n\n  return (\n    <Button fullWidth buttonType=\"primary\" onClick={handleClick}>\n      {saving ? <Loader isInsideButton /> : <>Save</>}\n    </Button>\n  );\n}\n\nexport default SaveButton;\n","import { Route, useHistory } from \"react-router-dom\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport styled from \"styled-components\";\nimport Button from \"carbon-react/lib/components/button\";\n\nimport { addColumn } from \"../redux/dependancies/dependanciesSlice\";\nimport { getReadOnly } from \"../redux/user/userSlice\";\n\nimport UserDetails from \"./UserDetails\";\nimport ComponentSearch from \"./ComponentSearch\";\nimport ShowHideAllArrows from \"./ShowHideAllArrows\";\nimport ShowHideOtherRelations from \"./ShowHideOtherRelations\";\nimport SaveButton from \"./SaveButton\";\nimport Typography from \"carbon-react/lib/components/typography\";\n\nconst SidebarWrap = styled.div`\n  width: 320px;\n  flex: 0 0 320px;\n  background: rgb(242, 245, 246);\n  position: relative;\n  z-index: 2;\n`;\n\nconst SidebarActions = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 0 2rem;\n  gap: 1rem;\n`;\n\nconst Hr = styled.hr`\n  margin: 2rem 0;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.1);\n`;\n\nfunction AppSidebar() {\n  const history = useHistory();\n  const dispatch = useDispatch();\n  const readonly = useSelector(getReadOnly);\n  return (\n    <SidebarWrap>\n      <Typography ml={4} mt={3} variant=\"h1\">\n        Dependancy Graph\n      </Typography>\n\n      <UserDetails />\n      <Hr />\n\n      <ComponentSearch />\n\n      <Hr />\n\n      <SidebarActions>\n        <Route path=\"/tree/\">\n          <ShowHideOtherRelations />\n\n          <Button fullWidth onClick={() => history.push(\"/\")}>\n            Columns View\n          </Button>\n\n          <Button fullWidth onClick={() => history.goBack()}>\n            Back\n          </Button>\n        </Route>\n\n        <Route exact path=\"/\">\n          <ShowHideAllArrows />\n\n          {!readonly && (\n            <Button\n              onClick={() => {\n                dispatch({ type: addColumn.toString() });\n              }}\n              fullWidth\n              iconType=\"plus\"\n            >\n              Add New Column\n            </Button>\n          )}\n        </Route>\n        <SaveButton />\n      </SidebarActions>\n    </SidebarWrap>\n  );\n}\n\nexport default AppSidebar;\n","import \"./App.css\";\r\nimport { HashRouter as Router, Switch, Route } from \"react-router-dom\";\r\n\r\n// import LoadData from \"./components/LoadData\";\r\nimport Guard from \"./components/Guard\";\r\nimport FirebaseSync from \"./components/FirebaseSync\";\r\nimport TreeView from \"./features/Tree/TreeView\";\r\nimport ColumnsView from \"./features/Columns/ColumnsView\";\r\n\r\nimport AppSidebar from \"./components/AppSidebar\";\r\n\r\nimport styled from \"styled-components\";\r\n\r\nconst AppWrap = styled.div`\r\n  display: flex;\r\n  min-height: 100vh;\r\n  width: 100%;\r\n  max-width: 100vw;\r\n  align-items: stretch;\r\n`;\r\n\r\nconst Wrap = styled.div`\r\n  flex: 0 1 calc(100% - 320px);\r\n  max-width: calc(100% - 320px);\r\n  position: relative;\r\n  z-index: 1;\r\n`;\r\n\r\nfunction App() {\r\n  return (\r\n    <AppWrap>\r\n      <Guard>\r\n        {/* <LoadData /> */}\r\n        <FirebaseSync />\r\n        <Router>\r\n          <AppSidebar />\r\n\r\n          <Wrap>\r\n            <Switch>\r\n              <Route path=\"/tree/:itemId\" component={TreeView} />\r\n              <Route path=\"/\" component={ColumnsView} />\r\n            </Switch>\r\n          </Wrap>\r\n        </Router>\r\n      </Guard>\r\n    </AppWrap>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import { configureStore } from \"@reduxjs/toolkit\";\r\n\r\nimport dependanciesReducer from \"./dependancies/dependanciesSlice\";\r\nimport connectionsReducer from \"./connections/connectionsSlice\";\r\nimport linkingReducer from \"./linking/linkingSlice\";\r\nimport optionsReducer from \"./options/optionsSlice\";\r\nimport userReducer from \"./user/userSlice\";\r\n\r\nexport default configureStore({\r\n  reducer: {\r\n    linking: linkingReducer,\r\n    dependancies: dependanciesReducer,\r\n    connections: connectionsReducer,\r\n    options: optionsReducer,\r\n    user: userReducer\r\n  },\r\n});\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl, {\r\n    headers: { 'Service-Worker': 'script' },\r\n  })\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","/* Add your config from the Firebase Console */\nconst firebaseConfig = {\n  apiKey: \"AIzaSyAESY7RU998b2rdyyWMhCkt4mfQXfEdpyM\",\n  authDomain: \"dependancy-graph.firebaseapp.com\",\n  projectId: \"dependancy-graph\",\n  storageBucket: \"dependancy-graph.appspot.com\",\n  messagingSenderId: \"257602314188\",\n  appId: \"1:257602314188:web:b6daa829c5e07f23648769\",\n};\nexport default firebaseConfig;\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport \"./index.css\";\r\nimport App from \"./App\";\r\nimport store from \"./redux/store\";\r\nimport { Provider } from \"react-redux\";\r\nimport * as serviceWorker from \"./serviceWorker\";\r\n\r\nimport GlobalStyle from \"carbon-react/lib/style/global-style\";\r\n\r\nimport \"firebase/firestore\";\r\nimport { FirebaseAppProvider } from \"reactfire\";\r\n\r\nimport firebaseConfig from \"./firebaseConfig\";\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <GlobalStyle />\r\n    <FirebaseAppProvider firebaseConfig={firebaseConfig}>\r\n      <Provider store={store}>\r\n        <App />\r\n      </Provider>\r\n    </FirebaseAppProvider>\r\n  </React.StrictMode>,\r\n  document.getElementById(\"root\")\r\n);\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}